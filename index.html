<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Torneo Tennis – Gironi</title>
<style>
 body {font-family: Arial, sans-serif; padding: 20px; background:#FFE5B4;} 
 h2 {margin-top:40px;}
 table {border-collapse: collapse; margin-bottom: 20px; width:100%;}
 th, td {border:1px solid #999; padding:6px; text-align:center;}
 th {background:#FFD580;}
 input[type="text"]{width:120px;}
 .match-row{margin-bottom:8px;}
</style>
</head>
<body>
<h1>Torneo Tennis – Fase a Gironi</h1>
<p>Inserisci i punteggi set per set. Lo script calcola automaticamente vincitore, punti e set.</p>

<div id="app"></div>

<script>
const groups = {
 A:["Andrea Calabrese","Mario Verrocchi","Francesco Giallonardo","Fabio Di Marcantonio"],
 B:["Emanuele Caputo","Fabrizio Giammarco","Lorenzo De Nuzzo","Massimiliano Giovannelli"],
 C:["Cristian Cianchetta","Matteo Ciampa","Ennio Ferzoco","Nicolo Grasso"],
 D:["Claudio Giammarco","Stefano Restaino","Fabio Formichetti","Andrea Marino"]
};

// Risultati iniziali: match precompilati ma con trattino
let results = {
  "Andrea Calabrese|Mario Verrocchi":"-",
  "Andrea Calabrese|Francesco Giallonardo":"-",
  "Andrea Calabrese|Fabio Di Marcantonio":"6-4 6-2",
  "Mario Verrocchi|Francesco Giallonardo":"6-3 6-7 6-10",
  "Mario Verrocchi|Fabio Di Marcantonio":"-",
  "Francesco Giallonardo|Fabio Di Marcantonio":"-",
  "Emanuele Caputo|Fabrizio Giammarco":"-",
  "Emanuele Caputo|Lorenzo De Nuzzo":"-",
  "Emanuele Caputo|Massimiliano Giovannelli":"-",
  "Fabrizio Giammarco|Lorenzo De Nuzzo":"-",
  "Fabrizio Giammarco|Massimiliano Giovannelli":"-",
  "Lorenzo De Nuzzo|Massimiliano Giovannelli":"-",
  "Cristian Cianchetta|Matteo Ciampa":"-",
  "Cristian Cianchetta|Ennio Ferzoco":"-",
  "Cristian Cianchetta|Nicolo Grasso":"-",
  "Matteo Ciampa|Ennio Ferzoco":"-",
  "Matteo Ciampa|Nicolo Grasso":"-",
  "Ennio Ferzoco|Nicolo Grasso":"-",
  "Claudio Giammarco|Stefano Restaino":"-",
  "Claudio Giammarco|Fabio Formichetti":"-",
  "Claudio Giammarco|Andrea Marino":"-",
  "Stefano Restaino|Fabio Formichetti":"-",
  "Stefano Restaino|Andrea Marino":"-",
  "Fabio Formichetti|Andrea Marino":"-"
};

function parseScore(score){
  if(score.trim() === "-" || score.trim() === "") return {winner:null, aSets:0, bSets:0};
  let sets = score.trim().split(/\s+/);
  let aSets=0,bSets=0;
  for (let s of sets){
    const [ga,gb]=s.split('-').map(Number);
    if(isNaN(ga)||isNaN(gb)) continue;
    if(ga>gb) aSets++; else bSets++;
  }
  let winner = aSets>bSets?0:1;
  return {winner,aSets,bSets};
}

function render(){
  const app=document.getElementById('app');
  app.innerHTML="";
  for(const g in groups){
    const players=groups[g];
    app.innerHTML+=`<h2>Girone ${g}</h2>`;
    
    for(let i=0;i<players.length;i++){
      for(let j=i+1;j<players.length;j++){
        const key = `${players[i]}|${players[j]}`;
        const val = results[key] || "-";
        app.innerHTML+=`
          <div class="match-row">
            ${players[i]} vs ${players[j]}:
            <input type="text" data-key="${key}" value="${val}">
          </div>`;
      }
    }

    let stats={};
    players.forEach(p=>stats[p]={points:0,played:0,setW:0,setL:0});
    for(const k in results){
      const [p1,p2]=k.split("|");
      if(!stats[p1]||!stats[p2]) continue;
      const r=parseScore(results[k]);
      if(r.winner === null) continue; // ignora match senza punteggio
      stats[p1].played++; stats[p2].played++;
      stats[p1].setW+=r.aSets; stats[p1].setL+=r.bSets;
      stats[p2].setW+=r.bSets; stats[p2].setL+=r.aSets;
      if(r.winner===0){
        const pts = (r.bSets===0)?3:2;
        stats[p1].points+=pts;
        stats[p2].points+=(r.bSets===0)?0:1;
      } else {
        const pts = (r.aSets===0)?3:2;
        stats[p2].points+=pts;
        stats[p1].points+=(r.aSets===0)?0:1;
      }
    }

    const ordered = Object.entries(stats).sort((a,b)=>
       b[1].points - a[1].points ||
       (b[1].setW-b[1].setL) - (a[1].setW-a[1].setL)
    );

    let table=`<table><tr>
      <th>Giocatore</th><th>Punti</th><th>Partite</th><th>Set W-L</th>
    </tr>`;
    for(const [p,s] of ordered){
      table+=`<tr><td>${p}</td>
                 <td>${s.points}</td>
                 <td>${s.played}</td>
                 <td>${s.setW}-${s.setL}</td></tr>`;
    }
    table+="</table>";
    app.innerHTML+=table;
  }

  document.querySelectorAll('input[data-key]').forEach(inp=>{
    inp.onchange=e=>{
      const k=e.target.dataset.key;
      if(e.target.value.trim()==="") results[k]="-";
      else results[k]=e.target.value.trim();
      render();
    };
  });
}

render();
</script>
</body>
</html>
